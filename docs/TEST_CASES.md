# 乡货通 (Xianghuotong) 测试用例文档

> **版本**: v1.0  
> **最后更新**: 2026-01-16  
> **测试范围**: IMP-002 ~ IMP-007

---

## 测试环境

| 环境     | 配置              |
| -------- | ----------------- |
| Node.js  | v18+              |
| 包管理器 | npm               |
| 测试框架 | Jest              |
| Vue 版本 | Vue3              |
| 组件库   | uView Plus        |
| 云服务   | UniCloud (阿里云) |

### 测试账号

| 角色     | 手机号                    | 用途       |
| -------- | ------------------------- | ---------- |
| 管理员   | 13003629527               | 全功能测试 |
| 测试商家 | 13800000001 ~ 13800000010 | 商家端测试 |
| 测试客户 | 13900000001 ~ 13900000010 | 客户端测试 |

---

## 测试用例清单

### IMP-002: 商家有效期管理

| 用例编号 | 模块      | 测试场景       | 预期结果              | 优先级 | 状态 |
| -------- | --------- | -------------- | --------------------- | ------ | ---- |
| T-002-01 | 登录      | 过期商家登录   | 提示"店铺已过期"      | P0     | ⬜   |
| T-002-02 | 登录      | 冻结商家登录   | 提示"店铺已被冻结"    | P0     | ⬜   |
| T-002-03 | 登录      | 待审核商家登录 | 提示"店铺正在审核中"  | P0     | ⬜   |
| T-002-04 | 登录      | 正常商家登录   | 登录成功              | P0     | ⬜   |
| T-002-05 | Dashboard | 过期横幅显示   | 红色横幅 + "立即续费" | P0     | ⬜   |
| T-002-06 | Dashboard | 即将过期横幅   | 橙色横幅 + 剩余天数   | P0     | ⬜   |
| T-002-07 | Setting   | 会员信息卡片   | 显示状态、到期时间    | P0     | ⬜   |
| T-002-08 | Admin     | 审核商家通过   | 状态变为"正常"        | P0     | ⬜   |
| T-002-09 | Admin     | 审核商家拒绝   | 状态变为"已拒绝"      | P0     | ⬜   |
| T-002-10 | Admin     | 冻结商家       | 状态变为"已冻结"      | P0     | ⬜   |
| T-002-11 | Admin     | 解冻商家       | 状态变回"正常"        | P0     | ⬜   |
| T-002-12 | Admin     | 续费操作       | 过期商家恢复          | P0     | ⬜   |
| T-002-13 | Admin     | 延长有效期     | 正确更新过期时间      | P0     | ⬜   |

### IMP-003: 客户全局关联表

| 用例编号 | 模块     | 测试场景       | 预期结果       | 优先级 | 状态 |
| -------- | -------- | -------------- | -------------- | ------ | ---- |
| T-003-01 | 扫码     | 首次扫码进店   | 创建关联记录   | P0     | ⬜   |
| T-003-02 | 我的商家 | 查看已关联商家 | 显示商家列表   | P0     | ⬜   |
| T-003-03 | 解绑     | 主动解绑商家   | 解除关联关系   | P1     | ⬜   |
| T-003-04 | 扫码     | 重复扫码进店   | 更新访问时间   | P0     | ⬜   |
| T-003-05 | 商家侧   | 查看客户列表   | 显示关联的客户 | P1     | ⬜   |

### IMP-004: 商家店铺二维码

| 用例编号 | 模块 | 测试场景       | 预期结果            | 优先级 | 状态 |
| -------- | ---- | -------------- | ------------------- | ------ | ---- |
| T-004-01 | 生成 | 生成店铺二维码 | 返回有效二维码      | P0     | ⬜   |
| T-004-02 | 扫码 | 客户扫码进入   | 解析 tenant_id 成功 | P0     | ⬜   |
| T-004-03 | 停用 | 停用二维码     | 旧二维码失效        | P1     | ⬜   |
| T-004-04 | 生成 | 重复生成       | 返回已有二维码      | P1     | ⬜   |
| T-004-05 | 分享 | 保存二维码图片 | 图片保存成功        | P1     | ⬜   |

### IMP-005: 商家注册流程

| 用例编号 | 模块 | 测试场景       | 预期结果              | 优先级 | 状态 |
| -------- | ---- | -------------- | --------------------- | ------ | ---- |
| T-005-01 | 注册 | 新商家注册     | 创建成功，状态=待审核 | P0     | ⬜   |
| T-005-02 | 注册 | 重复手机号     | 提示"已注册"          | P0     | ⬜   |
| T-005-03 | 注册 | 密码不一致     | 提示"密码不一致"      | P0     | ⬜   |
| T-005-04 | 注册 | 空字段校验     | 提示必填项            | P0     | ⬜   |
| T-005-05 | 登录 | 注册后登录     | 提示"正在审核中"      | P0     | ⬜   |
| T-005-06 | 审核 | 管理员审核通过 | 商家可正常登录        | P0     | ⬜   |
| T-005-07 | 审核 | 管理员拒绝     | 商家状态为已拒绝      | P0     | ⬜   |

### IMP-006: 财务报表统计

| 用例编号 | 模块   | 测试场景         | 预期结果          | 优先级 | 状态 |
| -------- | ------ | ---------------- | ----------------- | ------ | ---- |
| T-006-01 | 统计页 | 查看平台总商户   | 显示正确数量      | P1     | ⬜   |
| T-006-02 | 统计页 | 查看平台总客户   | 显示正确数量      | P1     | ⬜   |
| T-006-03 | 统计页 | 查看平台总营业额 | 显示正确金额      | P1     | ⬜   |
| T-006-04 | 统计页 | 查看月度趋势     | 显示最近3个月数据 | P1     | ⬜   |
| T-006-05 | 统计页 | 查看TOP商户      | 按订单量排序      | P1     | ⬜   |

### IMP-007: 扫码确认提示

| 用例编号 | 模块     | 测试场景     | 预期结果            | 优先级 | 状态 |
| -------- | -------- | ------------ | ------------------- | ------ | ---- |
| T-007-01 | 扫码     | 扫码后Toast  | 显示"已进入XXX店铺" | P2     | ⬜   |
| T-007-02 | 店铺页   | 店铺名称横幅 | 顶部显示店铺名      | P2     | ⬜   |
| T-007-03 | 手动输入 | 输入店铺码   | 成功进入店铺        | P2     | ⬜   |

---

## 单元测试用例

### 价格工具函数

| 用例编号   | 测试场景       | 预期结果 |
| ---------- | -------------- | -------- |
| U-TEST-001 | format(100)    | "1.00"   |
| U-TEST-002 | format(1234)   | "12.34"  |
| U-TEST-003 | format(0)      | "0.00"   |
| U-TEST-004 | toFen("1.00")  | 100      |
| U-TEST-005 | toFen("12.34") | 1234     |
| U-TEST-006 | toFen("0")     | 0        |

### Dashboard 组件

| 用例编号   | 测试场景             | 预期结果     |
| ---------- | -------------------- | ------------ |
| U-TEST-010 | 正常商家显示店铺名   | 显示正确     |
| U-TEST-011 | 过期商家显示红色横幅 | 显示正确     |
| U-TEST-012 | 即将过期显示橙色横幅 | 显示正确     |
| U-TEST-013 | 点击续费跳转         | 跳转正确页面 |

### Register 组件

| 用例编号   | 测试场景     | 预期结果     |
| ---------- | ------------ | ------------ |
| U-TEST-020 | 有效表单提交 | 调用 API     |
| U-TEST-021 | 无效表单提交 | 显示错误提示 |
| U-TEST-022 | 注册成功跳转 | 跳转到登录页 |

### Scan 组件

| 用例编号   | 测试场景       | 预期结果           |
| ---------- | -------------- | ------------------ |
| U-TEST-030 | JSON格式QR解析 | 正确提取 tenant_id |
| U-TEST-031 | 纯文本QR解析   | 正确提取内容       |
| U-TEST-032 | 无效QR码       | 显示错误提示       |

---

## 测试数据准备

### 数据库初始化

```javascript
// 测试前初始化数据
const testData = {
  // 过期商家
  expiredMerchant: {
    mobile: '13800000001',
    tenant: {
      name: '过期店铺测试',
      status: 1,
      expired_at: new Date(Date.now() - 86400000) // 昨天
    }
  },
  // 冻结商家
  frozenMerchant: {
    mobile: '13800000002',
    tenant: {
      name: '冻结店铺测试',
      status: 2,
      expired_at: new Date(Date.now() + 86400000 * 30)
    }
  },
  // 待审核商家
  pendingMerchant: {
    mobile: '13800000003',
    tenant: {
      name: '待审核店铺测试',
      status: 0,
      expired_at: null
    }
  },
  // 正常商家
  normalMerchant: {
    mobile: '13800000004',
    tenant: {
      name: '正常店铺测试',
      status: 1,
      expired_at: new Date(Date.now() + 86400000 * 30)
    }
  }
}
```

---

## 测试报告模板

### 执行摘要

```
测试执行日期: YYYY-MM-DD
测试执行人: XXX
总用例数: XX
通过: XX
失败: XX
未执行: XX
通过率: XX%
```

### 失败用例分析

| 用例编号 | 失败原因 | 解决方案 | 负责人 | 状态 |
| -------- | -------- | -------- | ------ | ---- |
|          |          |          |        |      |

---

## 变更记录

| 日期       | 版本 | 变更内容 | 变更人 |
| ---------- | ---- | -------- | ------ |
| 2026-01-16 | v1.0 | 初始版本 | AI助手 |
